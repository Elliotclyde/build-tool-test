import e from"/@npm/isarray@0.0.1";var t=pathToRegexp,n=parse,compile_1=function(e,t){return tokensToFunction(parse(e,t),t)},r=tokensToFunction,o=tokensToRegExp,a=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function parse(e,t){for(var n,r=[],o=0,i=0,p="",s=t&&t.delimiter||"/";null!=(n=a.exec(e));){var c=n[0],u=n[1],l=n.index;if(p+=e.slice(i,l),i=l+c.length,u)p+=u[1];else{var f=e[i],g=n[2],h=n[3],x=n[4],d=n[5],m=n[6],v=n[7];p&&(r.push(p),p="");var y=null!=g&&null!=f&&f!==g,E="+"===m||"*"===m,R="?"===m||"*"===m,T=n[2]||s,w=x||d;r.push({name:h||o++,prefix:g||"",delimiter:T,optional:R,repeat:E,partial:y,asterisk:!!v,pattern:w?escapeGroup(w):v?".*":"[^"+escapeString(T)+"]+?"})}}return i<e.length&&(p+=e.substr(i)),p&&r.push(p),r}function encodeURIComponentPretty(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function tokensToFunction(t,n){for(var r=new Array(t.length),o=0;o<t.length;o++)"object"==typeof t[o]&&(r[o]=new RegExp("^(?:"+t[o].pattern+")$",flags(n)));return function(n,o){for(var a="",i=n||{},p=(o||{}).pretty?encodeURIComponentPretty:encodeURIComponent,s=0;s<t.length;s++){var c=t[s];if("string"!=typeof c){var u,l=i[c.name];if(null==l){if(c.optional){c.partial&&(a+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(e(l)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(l)+"`");if(0===l.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var f=0;f<l.length;f++){if(u=p(l[f]),!r[s].test(u))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(u)+"`");a+=(0===f?c.prefix:c.delimiter)+u}}else{if(u=c.asterisk?encodeURI(l).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):p(l),!r[s].test(u))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+u+'"');a+=c.prefix+u}}else a+=c}return a}}function escapeString(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function escapeGroup(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function attachKeys(e,t){return e.keys=t,e}function flags(e){return e&&e.sensitive?"":"i"}function tokensToRegExp(t,n,r){e(n)||(r=n||r,n=[]);for(var o=(r=r||{}).strict,a=!1!==r.end,i="",p=0;p<t.length;p++){var s=t[p];if("string"==typeof s)i+=escapeString(s);else{var c=escapeString(s.prefix),u="(?:"+s.pattern+")";n.push(s),s.repeat&&(u+="(?:"+c+u+")*"),i+=u=s.optional?s.partial?c+"("+u+")?":"(?:"+c+"("+u+"))?":c+"("+u+")"}}var l=escapeString(r.delimiter||"/"),f=i.slice(-l.length)===l;return o||(i=(f?i.slice(0,-l.length):i)+"(?:"+l+"(?=$))?"),i+=a?"$":o&&f?"":"(?="+l+"|$)",attachKeys(new RegExp("^"+i,flags(r)),n)}function pathToRegexp(t,n,r){return e(n)||(r=n||r,n=[]),r=r||{},t instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return attachKeys(e,t)}(t,n):e(t)?function(e,t,n){for(var r=[],o=0;o<e.length;o++)r.push(pathToRegexp(e[o],t,n).source);return attachKeys(new RegExp("(?:"+r.join("|")+")",flags(n)),t)}(t,n,r):function(e,t,n){return tokensToRegExp(parse(e,n),t,n)}(t,n,r)}t.parse=n,t.compile=compile_1,t.tokensToFunction=r,t.tokensToRegExp=o;export default t;export{compile_1 as compile,n as parse,r as tokensToFunction,o as tokensToRegExp};